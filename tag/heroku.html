<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>modal_soul debriefing</title>
  <meta name="description" content="I guess you could call it a failure, but I prefer the term learning experience.">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/tag/heroku.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="modal_soul debriefing">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/tag/heroku.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <h2>Heroku</h2>
<ul>

  <li><a href="/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html">【意訳】Heroku上でPlayFramework + Scalaアプリケーションを実行する</a> (12 Aug 2012 | Tags: <!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【意訳】Heroku上でPlayFramework + Scalaアプリケーションを実行する</title>
  <meta name="description" content="誤訳・誤植等ありましたら、@modal_soulまでリプライいただけるとありがたいです。">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="【意訳】Heroku上でPlayFramework + Scalaアプリケーションを実行する">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <span class="col-md-9 col-lg-9">
    <header class="post-header">
      <time datetime="2012-08-12T00:00:00+09:00" itemprop="datePublished">Aug 12, 2012</time>
      <h1 class="post-title" itemprop="name headline">【意訳】Heroku上でPlayFramework + Scalaアプリケーションを実行する</h1>
      <div class="post-meta">
        <span class="tags-icon glyphicon glyphicon-folder-open" aria-hidden="true"></span>
        
          <a href="/programing" class="label label-default">Programing</a>
        
        <span class="tags-icon glyphicon glyphicon-tags" aria-hidden="true"></span>
        
          <a href="/tag/scala" class="label label-default">Scala</a>
        
          <a href="/tag/playframework" class="label label-default">PlayFramework</a>
        
          <a href="/tag/heroku" class="label label-default">Heroku</a>
        
      </div>
    </header>
    
      <div  class="thumbnail">
        <img src="http://capture.heartrails.com/200x150?http://www.jamesward.com/2011/10/19/running-play-framework-scala-apps-on-heroku" class="post-thumbnail"/>
      </div>
    

    <div class="post-content" itemprop="articleBody">
      <p>誤訳・誤植等ありましたら、<a href="https://twitter.com/modal_soul">@modal_soulまで</a>リプライいただけるとありがたいです。</p>

<hr />

<p><a href="http://scala.playframework.org/">ScalaでPlay Frameworkアプリを構築</a>するのが最近流行っているようです。理由としては、これまでのJVMベースのWebアプリよりも簡単に構築、デプロイできることです。ScalaでPlayアプリの構築とHerokuへのデプロイをやってみましょう。</p>

<hr />

<p><em>Step1) <a href="http://www.playframework.org/download">Play Framework</a>をインストールします（バージョン1.2.3以上をインストールしてください)。</em></p>

<hr />

<p><em>Step2) Play Scalaモジュールをインストールします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play install scala</code></pre></figure>

<hr />

<p><em>Step3) ScalaサポートしたPlayアプリを作成します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play new playwithscala --with scala</code></pre></figure>

<hr />

<p><em>Step4) アプリケーションをスタートします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">cd </span>playwithscala
play run</code></pre></figure>

<hr />

<p><em>Step5) ブラウザでアプリケーションを開きます。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">http://localhost:9000</code></pre></figure>

<p>とても簡単ですね。Heroku上にデプロイする前に、カスタムmodel, view, controllerを追加してもう少し味付けしてみましょう。</p>

<hr />

<p><em>Step1) app/models/Widget.scalaを新規作成して、以下を記述します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package models
 
<span class="k">case</span> class Widget<span class="o">(</span>id: Int, name: String<span class="p">)</span></code></pre></figure>

<hr />

<p><em>Step2) app/views/Widget/list.scala.htmlファイルを新規作成して、以下を記述します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"> ＠<span class="o">(</span>widgets: Vector[models.Widget]<span class="o">)</span>
 
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;body&gt;
        @widgets.map <span class="o">{</span> widget <span class="o">=</span>&gt; 
            Widget @widget.id <span class="o">=</span> @widget.name&lt;/br&gt;
        <span class="o">}</span>
    &lt;/body&gt;
&lt;/html&gt;</code></pre></figure>

<hr />

<p><em>Step3) app/controllers/WidgetController.scalaを新規作成して、以下を記述します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package controllers
 
import play._
import play.mvc._
 
object WidgetController extends Controller <span class="o">{</span>
 
    import views.Widget._
    import models.Widget
 
    def list <span class="o">=</span> <span class="o">{</span>
        val widget1 <span class="o">=</span> Widget<span class="o">(</span>1, <span class="s2">"The first Widget"</span><span class="o">)</span>
        val widget2 <span class="o">=</span> Widget<span class="o">(</span>2, <span class="s2">"A really special Widget"</span><span class="o">)</span>
        val widget3 <span class="o">=</span> Widget<span class="o">(</span>3, <span class="s2">"Just another Widget"</span><span class="o">)</span>
        html.list<span class="o">(</span>Vector<span class="o">(</span>widget1, widget2, widget3<span class="o">))</span>
    <span class="o">}</span>
 
<span class="o">}</span></code></pre></figure>

<p><em>Step4) 以下のURLを表示して、動きを確認しましょう。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">http://localhost:9000/WidgetController/list</code></pre></figure>

<p>動きましたね。それにサーバーのリロードも不要でした。URLを少しきれいにしましょう。conf/routeファイルを修正して、”Application.index”を”WidgetController.list”へ変更します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">GET     /                                       WidgetController.list</code></pre></figure>

<p>簡単にできましたが、ついでに友達にも見せたいですね。Herokuへデプロイしましょう。</p>

<hr />

<p><em>Step1) Linux, MacもしくはWindowsに、Herokuコマンドクライアントをインストールします。</em></p>

<p><em>Step2) コマンドラインからHerokuへログインします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku auth:login</code></pre></figure>

<p><em>Step3) Herokuは、アプリケーションのデプロイにgitを使うので、.gitignoreファイルを作成して、以下を記述します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">/modules
/tmp</code></pre></figure>

<p><em>Step4) gitリポジトリを作成して、ファイルを追加し、コミットします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">git init
git add .
git commit -m init</code></pre></figure>

<p><em>Step5) Herokuにアプリケーションを新規作成します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku create -s cedar</code></pre></figure>

<p>これで、Heroku上に新しいアプリケーションを規定し、アプリケーションへのランダムな名前/のURLを割り当てます。</p>

<p><em>Step6) アプリケーションをデプロイします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">git push heroku master</code></pre></figure>

<p>アプリケーションがアセンブルされ、Heroku上にデプロイされます。</p>

<p><em>Step7) ブラウザでアプリケーションを開きます。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku open</code></pre></figure>

<p>ジャジャーン！これでPlay + Scala アプリがクラウド上で実行されました。</p>

<p>JavaOneで、これをBill Venners(ScalaTestの作者)に見せたら、scalatest.orgのWebサイト（Play + Scalaのアプリ)をHerokuへ移行してくれました。クール！</p>

<p>何か質問あれば、教えてください。</p>


    </div>
    <div class="footer">
      <span class="social-button">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://modalsoul.github.io/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html/" data-via="modal_soul" data-lang="ja">ツイート</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <a href="http://b.hatena.ne.jp/entry/modalsoul.github.io/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html" class="hatena-bookmark-button" data-hatena-bookmark-title="【意訳】Heroku上でPlayFramework + Scalaアプリケーションを実行する" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
    <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
  </a>
  <div class="fb-like" data-href="http://modalsoul.github.io/programing/2012/08/12/Running-PlayFramework-Scala-Apps-on-Heroku.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>

  <!-- このタグを +1 ボタンを表示する場所に挿入してください -->
  <g:plusone size="medium"></g:plusone>

</span>

    </div>
    <div class="post-paginator">
      
      <span class="next label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/test/programing/2012/08/30/android-ui-test-touchutils-performclick.html" aria-label="Next">
          <span aria-hidden="true">&laquo;TouchUtilsを使ったAndroidテストでjava.lang.SecurityException:PermissionDenialが起きたときの回避方法</span>
        </a>
      </span>
      
      
      <span class="previous label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/08/10/Sign-in-with-Facebook-Scala.html" aria-label="Previous">
          <span aria-hidden="true">【意訳】Scala on LiftでのFacebookサインイン&raquo;</span>
        </a>
      </span>
      
    </div>
    <div id="disqus_thread">
  <a href="http://modalsoul.github.io#disqus_thread">Link</a>
</div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = http://modalsoul.github.io; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//modalsoul.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </span>
  <span class="right-navi col-md-3 col-lg-3">
    <h3>Latest post:</h3>
    <ul class="post-list">
      
        <li><a href="/programming/2017/02/02/openwhisk-scala-sbt-giter8-template.html">OpenWhiskのScala sbtプロジェクトのgiter8テンプレートを作った</a></li>
      
        <li><a href="/programming/2017/01/24/serverless-architecture-starting-with-openwhisk-and-scala.html">OpenWhisk+Scalaで作るServerless Architectureとっかかり</a></li>
      
        <li><a href="/programming/2017/01/22/deploy-playframework-application-to-bluemix.html">BluemixにPlayframeworkアプリケーションをデプロイする</a></li>
      
        <li><a href="/programming/2017/01/20/giter8-sbt-new-integration.html">sbt、Giter8を統合するってよ</a></li>
      
        <li><a href="/programming/2016/11/10/scala-sam-type.html">Scala 2.12.0でSAM型</a></li>
      
    </ul>
    <h3>Recent Books:</h3>
    <ul class="books-list">
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=427421933X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22" target="_blank">
      新装版 達人プログラマー 職人から名匠への道
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4798046140&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22" target="_blank">
      プリンシプル オブ プログラミング3年目までに身につけたい一生役立つ101の原理原則
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4844381490&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22" target="_blank">
      Scalaスケーラブルプログラミング第3版
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4822251551&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22" target="_blank">
      SOFT SKILLS ソフトウェア開発者の人生マニュアル
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=487311750X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22" target="_blank">
      Sparkによる実践データ解析 ―大規模データのための機械学習事例集
    </a>
  </div>
</div>

</li>
      
    </ul>
  </span>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
)</li>

  <li><a href="/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html">【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja</a> (31 Jul 2012 | Tags: <!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja</title>
  <meta name="description" content="この記事は、HerokuのPrincipal Developer EvangelistのJames Ward氏とRyan Knight氏の記事Getting Started with Play 2, Scala, and Squerylの意訳です。参考程度にどうぞ。">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <span class="col-md-9 col-lg-9">
    <header class="post-header">
      <time datetime="2012-07-31T00:00:00+09:00" itemprop="datePublished">Jul 31, 2012</time>
      <h1 class="post-title" itemprop="name headline">【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja</h1>
      <div class="post-meta">
        <span class="tags-icon glyphicon glyphicon-folder-open" aria-hidden="true"></span>
        
          <a href="/programing" class="label label-default">Programing</a>
        
        <span class="tags-icon glyphicon glyphicon-tags" aria-hidden="true"></span>
        
          <a href="/tag/play2" class="label label-default">Play2</a>
        
          <a href="/tag/heroku" class="label label-default">Heroku</a>
        
          <a href="/tag/database-driven" class="label label-default">Database-Driven</a>
        
          <a href="/tag/scala" class="label label-default">Scala</a>
        
          <a href="/tag/squeryl" class="label label-default">Squeryl</a>
        
          <a href="/tag/coffeescript" class="label label-default">CoffeeScript</a>
        
          <a href="/tag/json" class="label label-default">JSON</a>
        
          <a href="/tag/jquery" class="label label-default">jQuery</a>
        
          <a href="/tag/scalatest" class="label label-default">ScalaTest</a>
        
      </div>
    </header>
    

    <div class="post-content" itemprop="articleBody">
      <p>この記事は、HerokuのPrincipal Developer EvangelistのJames Ward氏とRyan Knight氏の記事<a href="http://www.artima.com/articles/play2_scala_squeryl.html">Getting Started with Play 2, Scala, and Squeryl</a>の意訳です。参考程度にどうぞ。</p>

<p><img src="http://capture.heartrails.com/300x200/cool?http://www.artima.com/articles/play2_scala_squeryl.html" alt="Getting Started with Play 2, Scala, and Squeryl" /></p>

<p>誤訳・誤植等ありましたら、<a href="https://twitter.com/modal_soul">@modal_soul</a>までリプライいただけるとありがたいです。</p>
<hr />

<h2 id="section">サマリー</h2>
<table border="1"><tr><td>
この記事では、Play2,Scala,Squeryl,JSON,CoffeScript,CoffeScript,jQueryとScalaTestを使ったWebアプリケーションの作り方を紹介します。また、同時にScalaTestを使ったテスト方法とHerokuを使ったクラウド環境へのアプリケーションデプロイについても学べます。
</td></tr>
</table>

<p>Play2,Scala,Squeryl,JSON,CoffeScript,jQueryとScalaTestの組み合わせによって、モダンなWebアプリケーションの構築とテストを効率的に行うことができ,
シンプルなデータベース駆動Webアプリケーションの構築、テスト、クラウドへのデプロイを体験できます。</p>

<h2 id="play2">Play2の紹介</h2>
<p>Play2は数あるWebフレームワークの中でも、ステートレスアーキテクチャで設計された、ユニークなWebフレームワークです。
Play2は、メモリやCPUなどのリソースの消費を抑えた、とても軽量なフレームワークです。
ステートレスであるため、昨今クラウドアーキテクチャにとって重要な、水平のスケーリングを容易に行うことができます。
他のアーキテクチャの特徴としては、完全に非同期なHTTPプログラミングモデルを使った、Websocketやcometのようなlong lived-connectionを利用するために設計されていることです。</p>

<p>また他の特徴としては、Herokuのようなクラウドアプリケーションプラットフォームへのデプロイに適するように、完璧に完結していることです。
Playアプリケーションのデプロイはシンプルで、コンテナベースのアプローチをしてきたJava開発者の多くが経験してきた環境齟齬を回避することができます。</p>

<p>Ruby on Rails, GrailsやDjangoなどの新しいWebフレームワークは、動的型付によってとても優れた生産性を発揮します。Playも動的言語フレームワークが持っているのと同じように、素早い繰り返しと高速な開発を行うことができ、しかしながらJavaやScalaのような静的型付言語による恩恵も留めています。これによりコンパイラは生産性を妨害することなく開発者を支援することができます。</p>

<h2 id="squeryl">Squerylの紹介</h2>
<p>データベースとのインテグレーションに最適の技術は何か？これは今まで幾度と無く討論されてきました。幸いなことに、JavaやScalaのエコシステムでは、データの永続化の方法が複数用意され、選択することができます。
Play2のデフォルトのデータベースマッピングツールはAnormが使われています。(※AnormはORMではありません)
名前が指し示す通り、Anormはオブジェクトとリレーショナルモデルとの自動マッピングを行いません。
代わりに、開発者はネイティブなSQLを書き、手動でリレーショナルデータとオブジェクトのマッピングを行います。
この手法では、実行される生のクエリーをチューニングすることができるという利点があります。
Playの開発者は、SQLを使用することはリレーショナルデータベースとの対話とSQL層を抽象化することにおいての優れたDSLであり、パワフルで柔軟な方法だと主張してます。</p>

<p>Squerylは、Scalaにおけるデータ永続化のためのAnormの代替手段です。Anormと比較して、SquerylはHibernateに似ており、オブジェクトリレーショナルマッピングを提供します。Squerylはデータベースとの対話において、型安全なDSLを提供します。
またSquerylは、明示的に取得されるデータオブジェクトの粒度を制御することができます。
Hibernateのような従来のORMと共通のN+1問題に対するエレガントなソリューションを提供します。</p>

<p>SquerylはPlay2のデフォルトのデータ永続化ライブラリではありませんが、特別な追加設定やセットアップは必要としません。データベースエボリューションは手動で行う必要があり、データベース接続は初期起動時に生成する必要があります。トランザクションも同様に、コントローラーで呼ばれた際に、明示的に定義される必要があります。</p>

<h2 id="play2squeryl">Play2でのSquerylのセットアップ</h2>
<p>Play2プロジェクトがまだない場合、Play2をインストール後、新規プロジェクトを作成しましょう。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play new mysquerylapp</code></pre></figure>

<p>プロジェクトの言語はScalaを選択しましょう。</p>

<p>SquerylライブラリをPlayプロジェクトに追加する必要があります。後ほどプロジェクトはHerokuにデプロイします。HerokuのデフォルトのデータベースはPostgreSQLで、PostgreJDBCドライバーも依存関係にあるためここで追加します。</p>

<p>project/Build.scalaファイルを編集し、依存関係を更新しましょう。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">val appDependencies <span class="o">=</span> Seq<span class="o">(</span>
  <span class="s2">"org.squeryl"</span> %% <span class="s2">"squeryl"</span> % <span class="s2">"0.9.5-2"</span>,
  <span class="s2">"postgresql"</span> % <span class="s2">"postgresql"</span> % <span class="s2">"9.1-901-1.jdbc4"</span>
<span class="o">)</span></code></pre></figure>

<p>IDEにEclipseやIntellijを使っている場合、Playはプロジェクトを自動作成してくれます。</p>

<p>Intellijの場合</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play idea</code></pre></figure>

<p>Eclipseの場合</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play eclipsify</code></pre></figure>

<p>ここでは注意ですが、プロジェクトファイルは依存関係を更新した後に作成しましょう。なぜならプロジェクトは必要なライブラリも含めて構成されるからです。もし後で依存関係を更新する場合は、プロジェクトを生成するコマンドを再度実行してください。</p>

<p>これでプロジェクトを実行することができます。プロジェクトルートに移動し、以下のコマンドを実行しましょう。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play ~run</code></pre></figure>

<p>サーバは以下のURLで起動しています。確かめてみましょう。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">http://localhost:9000</code></pre></figure>

<p>ローカルでのテストではインメモリのh2データベースを使用します。Playでこのデータベースを使用するには、conf/application.confファイルを修正し、以下の行のコメントアウトの解除か、行の追加をします。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">db.default.driver<span class="o">=</span>org.h2.Driver
db.default.url<span class="o">=</span><span class="s2">"jdbc:h2:mem:play"</span></code></pre></figure>

<p>最後のセットアップ手順として、Squerylデータベースを接続します。データベースの接続情報を取得するために、Play標準の構成システムを使います。
Playアプリケーションのライフサイクルのスタートアップフェーズにフックするグローバルクラスを追加するだけで完了です。
app/Global.scalaファイルを新規に作成し、以下を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">import org.squeryl.adapters.<span class="o">{</span>H2Adapter, PostgreSqlAdapter<span class="o">}</span>
import org.squeryl.internals.DatabaseAdapter
import org.squeryl.<span class="o">{</span>Session, SessionFactory<span class="o">}</span>
import play.api.db.DB
import play.api.GlobalSettings

import play.api.Application

object Global extends GlobalSettings <span class="o">{</span>

  override def onStart<span class="o">(</span>app: Application<span class="o">)</span> <span class="o">{</span>
    SessionFactory.concreteFactory <span class="o">=</span> app.configuration.getString<span class="o">(</span><span class="s2">"db.default.driver"</span><span class="o">)</span> match <span class="o">{</span>
      <span class="k">case</span> Some<span class="o">(</span><span class="s2">"org.h2.Driver"</span><span class="p">)</span> <span class="o">=</span>&gt; Some<span class="o">(()</span> <span class="o">=</span>&gt; getSession<span class="o">(</span>new H2Adapter, app<span class="o">))</span>
      <span class="k">case</span> Some<span class="o">(</span><span class="s2">"org.postgresql.Driver"</span><span class="p">)</span> <span class="o">=</span>&gt; Some<span class="o">(()</span> <span class="o">=</span>&gt; getSession<span class="o">(</span>new PostgreSqlAdapter, app<span class="o">))</span>
      <span class="k">case</span> _ <span class="o">=</span>&gt; sys.error<span class="o">(</span><span class="s2">"Database driver must be either org.h2.Driver or org.postgresql.Driver"</span><span class="p">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  def getSession<span class="o">(</span>adapter:DatabaseAdapter, app: Application<span class="o">)</span> <span class="o">=</span> Session.create<span class="o">(</span>DB.getConnection<span class="o">()(</span>app<span class="o">)</span>, adapter<span class="o">)</span>

<span class="o">}</span></code></pre></figure>

<p>アプリケーションスタートアップのdb.default.driver設定パラメータは、データベース接続のセットアップのために使用するドライバを決定するために使われます。新しいコネクションが生成され、SquerylのSessionFactoryにストアされます。</p>

<p>ブラウザで、http://localhost:9000をリロードすると、アプリケーションが動作し、PlayのSTDOUTログで以下のメッセージが表示されるはずです。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="o">[</span>info] play - database <span class="o">[</span>default] connected at jdbc:h2:mem:play</code></pre></figure>

<h2 id="entity">Entityの作成</h2>
<p>それでは、データベースでデータを保持するためのシンプルなEntityオブジェクトを作成しましょう。app/models/Bar.scalaファイルを新規に作成し、以下のを記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package models

import org.squeryl.<span class="o">{</span>Schema, KeyedEntity<span class="o">}</span>

<span class="k">case</span> class Bar<span class="o">(</span>name: Option[String]<span class="p">)</span> extends KeyedEntity[Long] <span class="o">{</span>
  val id: Long <span class="o">=</span> 0
<span class="o">}</span>

object AppDB extends Schema <span class="o">{</span>
  val barTable <span class="o">=</span> table［Bar］<span class="o">(</span><span class="s2">"bar"</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p>これはBarオブジェクトのリストを保持するかなりシンプルなentityです。各々のBarはnameとプライマリキーとしてIDを持っています。Scalaのcase classは,不変で、基本的にクラスを文法上の便宜で満たすものです。また、クライアントから返却されたフォーム値のマッチングを行う際にとても便利なパターンマッチングとして使用することもできます。AppDBオブジェクトは、Squerylがデータベースへマッピングするスキーマのインスタンスです。今回の場合、データベースにbarというテーブルを１つ定義します。スキーマは単一のオブジェクトとして宣言されるため、シングルトンオブジェクトを生成します。</p>

<p>Squerylを使うと、AppDB.createメソッドを呼ぶだけでプラグラムチックにデータベーススキーマを生成することができます。ですが、手動でSQLスクリプトを作成する方法をお勧めします（PlayではこのSQLスクリプトをevolutions scriptと呼びます)。Playは、これらのSQLスクリプトに対応するデータベーススキーマをチェックして、データベーススキーマの変更を追跡します。Playは、スキーマが古くなっていることを検出すると、このSQLスクリプトの適用を提案してきます。これはDEVモードのときにのみ行われ、PRODモードでは、アプリケーションの起動前にスクリプトを適用されます。これにより、データベーススキーマの変更やバージョンのロールバックを行う必要がある場合に、スキーマの変更をコントロールすることができます。</p>

<p>conf/evolutions/default/1.sqlファイルを新規作成して、以下を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="c"># --- First database schema</span>

<span class="c"># --- !Ups</span>

create sequence s_bar_id;

create table bar <span class="o">(</span>
  id    bigint DEFAULT nextval<span class="o">(</span><span class="s1">'s_bar_id'</span><span class="o">)</span>,
  name  varchar<span class="o">(</span>128<span class="o">)</span>
<span class="o">)</span>;


<span class="c"># --- !Downs</span>

drop table bar;
drop sequence s_bar_id;</code></pre></figure>

<p>このSQLファイルは”Ups”と”Downs”の2つのセクションから成っています。”Ups”セクションは、データベーススキーマに変更を反映させ、”Downs”セクションは、データベースへの変更を取り消す際の記述です。Playは、データベーススキーマへの変更をこれらのファイルの名前順に適用します。もし、デプロイ後1.sqlの適用後にスキーマへ変更を行う必要がある場合は、2.sqlファイルに変更内容を記述します。
http://localhost:9000をリロードすると、Playがデータベースへの変更を適用するか尋ねてくるはずです。1.sqlの”Ups”セクションをローカルのインメモリデータベースに適用するために、Apply this script now!ボタンをクリックします。</p>

<h2 id="section-1">モデルのテスト</h2>

<p>Play2では、テスト駆動開発のスタイルに合った強力なテストサポートがなされています。ScalaでPlay2を使う場合、テストはデフォルトでspaes2が使われていますが、ScalaTestを使用します。Barモデルオブジェクトのシンプルなテストを作ります。プロジェクトにScalaTestの依存関係を追加し、testOptions設定を修正します。project/Build.scalaを以下を追記して更新します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">val appDependencies <span class="o">=</span> Seq<span class="o">(</span>
  <span class="s2">"org.scalatest"</span> %% <span class="s2">"scalatest"</span> % <span class="s2">"1.8"</span> % <span class="s2">"test"</span>,
  <span class="s2">"org.squeryl"</span> %% <span class="s2">"squeryl"</span> % <span class="s2">"0.9.5-2"</span>,
  <span class="s2">"postgresql"</span> % <span class="s2">"postgresql"</span> % <span class="s2">"9.1-901-1.jdbc4"</span>
<span class="o">)</span>

val main <span class="o">=</span> PlayProject<span class="o">(</span>appName, appVersion, appDependencies, mainLang <span class="o">=</span> SCALA<span class="o">)</span>.settings<span class="o">(</span>
  testOptions <span class="k">in </span>Test :<span class="o">=</span> Nil
  // Add your own project settings here
<span class="o">)</span></code></pre></figure>

<p>test/BarSpec.scalaを新規作成し以下を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">import models.<span class="o">{</span>AppDB, Bar<span class="o">}</span>

import org.scalatest.FlatSpec
import org.scalatest.matchers.ShouldMatchers

import org.squeryl.PrimitiveTypeMode.inTransaction

import play.api.test._
import play.api.test.Helpers._

class BarSpec extends FlatSpec with ShouldMatchers <span class="o">{</span>

  <span class="s2">"A Bar"</span> should <span class="s2">"be creatable"</span> <span class="k">in</span> <span class="o">{</span>
    running<span class="o">(</span>FakeApplication<span class="o">(</span>additionalConfiguration <span class="o">=</span> inMemoryDatabase<span class="o">()))</span> <span class="o">{</span>
      inTransaction <span class="o">{</span>
        val bar <span class="o">=</span> AppDB.barTable insert Bar<span class="o">(</span>Some<span class="o">(</span><span class="s2">"foo"</span><span class="o">))</span>
        bar.id should not equal<span class="o">(</span>0<span class="o">)</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>このテストでは、実行するためにFakeApplicationとインメモリデータベースを使います。FakeApplicationを使用すると、Squerylデータベースコネクションは先に生成されたGlobalオブジェクトを使って構成されます。テスト本体は単純にBarのインスタンスを生成し、idが０ではないことをテストします。
これはSquerylトランザクションで行われます。
1系のPlayと異なり、テストはコマンドラインから実行されます。コマンドは以下</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play <span class="nb">test</span></code></pre></figure>

<p>テストが終了したら、以下のメッセージがPlayのSTDOUTログに出力されていることを確認します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="o">[</span>info] Passed: : Total 1, Failed 0, Errors 0, Passed 1, Skipped 0</code></pre></figure>

<p>ソースの変更の度にテストを実行するには、以下のコマンドで実行します</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play ~test</code></pre></figure>

<p>~runと~testコマンドはバックグラウンドで継続して実行することができます。これにより、ユニットテスト/機能テストやブラウザからの手動テストをすぐさま実行することができます。</p>

<h2 id="webbar">WebフォームからBarを生成する</h2>

<p>新しくBarオブジェクトを生成するための基本的なWeb UIを追加してみましょう。このセクションの手順を全て踏まないとコードのコンパイルができないので注意してください。</p>

<p>最初に、app/controllers/Application.scalaファイルを下記の記述を追加して更新します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package controllers

import play.api.mvc._

import com.codahale.jerkson.Json
import play.api.data.Form
import play.api.data.Forms.<span class="o">{</span>mapping, text, optional<span class="o">}</span>

import org.squeryl.PrimitiveTypeMode._
import models.<span class="o">{</span>AppDB, Bar<span class="o">}</span>


object Application extends Controller <span class="o">{</span>

  val barForm <span class="o">=</span> Form<span class="o">(</span>
    mapping<span class="o">(</span>
      <span class="s2">"name"</span> -&gt; optional<span class="o">(</span>text<span class="o">)</span>
    <span class="o">)(</span>Bar.apply<span class="o">)(</span>Bar.unapply<span class="o">)</span>
  <span class="o">)</span>

  def index <span class="o">=</span> Action <span class="o">{</span>
    Ok<span class="o">(</span>views.html.index<span class="o">(</span>barForm<span class="o">))</span>
  <span class="o">}</span>

  def addBar <span class="o">=</span> Action <span class="o">{</span> implicit request <span class="o">=</span>&gt;
    barForm.bindFromRequest.value map <span class="o">{</span> bar <span class="o">=</span>&gt;
      inTransaction<span class="o">(</span>AppDB.barTable insert bar<span class="o">)</span>
      Redirect<span class="o">(</span>routes.Application.index<span class="o">())</span>
    <span class="o">}</span> getOrElse BadRequest
  <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>barFormは、リクエストパラメーターnameからcace class Barのプロパティnameへ（コンストラクタを通して）マッピングをします。indexメソッドは、index templateへbarFormのインスタンスを渡すように更新されました。次にtemplateを更新します。addBarメソッドは、リクエストパラメーターをオブジェクトbarにバインドし、トランザクション内でデータベースへインサートします。SquerylはPlay frameworkに統合されていないので、データベーストランザクションはSquerylのinTransactionを使って明示的に開始する必要があります。次にユーザはindexページにリダイレクトされます。リクエストパラメータがbarFormを使ってBarにマッピングされなかった場合、BadRequestエラーが返却されます。</p>

<p>次にapp/views/index.scala.htmlテンプレートに以下を追記して更新します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"> ＠<span class="o">(</span>form: play.api.data.Form[Bar]<span class="o">)</span>

 ＠main<span class="o">(</span><span class="s2">"Welcome to Play 2.0"</span><span class="o">)</span> <span class="o">{</span>

    @helper.form<span class="o">(</span>action <span class="o">=</span> routes.Application.addBar<span class="o">)</span> <span class="o">{</span>
        @helper.inputText<span class="o">(</span>form<span class="o">(</span><span class="s2">"name"</span><span class="o">))</span>
        &lt;input <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span>/&gt;
    <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>この時点で、テンプレートはApplication Controllerのindexメソッドから渡されたForm[Bar]パラメータを取ります。テンプレート本体の新しいHTMLフォームはPlay2のform helperを使ってレンダリングされます。このフォームは、nameフィールドとsubmitボタンを持ちます。注意しなければいけないのは、フォームのアクションは、ルートからApplication controllerのaddBarメソッドへを指していることです。</p>

<p>この時点でコンソールウィンドウをみると”value addBar is not a member of controllers.ReverseApplication”エラーがみられると思います。
これは、routeファイルがコンパイルされ、routeがチェックされたからです。まだrouteが作られていないので、conf/routesファイルを編集し、以下の行を追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">POST    /bars                       controllers.Application.addBar</code></pre></figure>

<p>これにより、/barsURLへのPOSTリクエストをaddBarメソッドへマッピングするHTTPルートを作成します。</p>

<p>ブラウザでhttp://localhost:9000 を更新すると、新しいBarオブジェクトを追加するための基本的なフォームが表示されているはずです。成功した場合、新しいBarを追加した後に、ブラウザはindexページにリダイレクトして戻ります。</p>

<p>これで一通りが動くようになったので、controllerのコードに戻り、これらの動作についてより理解しましょう。addBarメソッドについて理解することは、コンパイラが周囲のスコープから値を見つけるために、どのように暗黙的なキーワードを通知するかを理解するのに役立ちます。Scalaでは、implicitキーワードは、implicit関数のパラメータもしくは、inplicitオブジェクトへの変換としても使用することができます。二つは全く異なりますが、両方ともにScalaの定義を解決する方法に関連しています。この場合、implicitは一つもしくはそれ以上の関数を呼ぶ場合と全ての関数に同じあたいを渡す必要がある場合に使われます。この手順は、APIを構成する際に便利で、ユーザはいつも何のパラメータが使用されるかについて明示する必要がなくなりますが、変わりにデフォルト値に依存します。</p>

<p>addBarの場合、barForm.bindFromRequestメソッドがplay.api.mvc.Requestパラメータをとり、明示的に渡す必要がないため、リクエストをimplicitと明示します。</p>

<p>参考に、Form.bindToRequestメソッドのメソッド定義を記載します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">def bindFromRequest<span class="o">()(</span>implicit request: play.api.mvc.Request[_]<span class="o">)</span>: Form[T] <span class="o">=</span> <span class="o">{</span>...<span class="o">}</span></code></pre></figure>

<p>bindFromRequestはフォームオブジェクトを返します。addBarメソッドでは、この場合Option[Bar]を返却するFormインスタンスのvalueメソッドを呼び出します。そして、呼び出しもとのマップがBarを取得し、フォームマッピングから生成できれば生成し、そうでなければgetOrElseステートメントはBadRequestを返却します。Barオブジェクトが生成することができた場合、それはトランザクション内でデータベースに保存されます。</p>

<p>これで、Squerylでリクエストパラメータとオブジェクトをマップしオブジェクトを保存する方法について理解できたと思うので、新しいaddBar controllerメソッドのテストを書きましょう。</p>

<h2 id="bar">Barの追加のテスト</h2>

<p>下記の記述を新規作成したtest/ApplicationSpec.scalaファイルを記述し、addBar controllerメソッドの新しいテストを作ります。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">import controllers.routes
import models.<span class="o">{</span>AppDB, Bar<span class="o">}</span>

import org.scalatest.FlatSpec
import org.scalatest.matchers.ShouldMatchers

import org.squeryl.PrimitiveTypeMode.inTransaction

import play.api.http.ContentTypes.JSON
import play.api.test._
import play.api.test.Helpers._

class ApplicationSpec extends FlatSpec with ShouldMatchers <span class="o">{</span>

  <span class="s2">"A request to the addBar action"</span> should <span class="s2">"respond"</span> <span class="k">in</span> <span class="o">{</span>
    running<span class="o">(</span>FakeApplication<span class="o">(</span>additionalConfiguration <span class="o">=</span> inMemoryDatabase<span class="o">()))</span> <span class="o">{</span>
      val result <span class="o">=</span> controllers.Application.addBar<span class="o">(</span>FakeRequest<span class="o">()</span>.withFormUrlEncodedBody<span class="o">(</span><span class="s2">"name"</span> -&gt; <span class="s2">"FooBar"</span><span class="o">))</span>
      status<span class="o">(</span>result<span class="o">)</span> should equal <span class="o">(</span>SEE_OTHER<span class="o">)</span>
      redirectLocation<span class="o">(</span>result<span class="o">)</span> should equal <span class="o">(</span>Some<span class="o">(</span>routes.Application.index.url<span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>機能テストではインメモリーデータベースとFakeApplicationを使います。テストでは、Application controllerのaddBarメソッドへのリクエストとnameという名前でFooBarという値のフォームパラメータを生成します。このテストの成功は、シンプルにindexページへリダイレクトされることで、ステータスがSEE_OTHER(HTTP 303ステータスコード)であるかをチェックし、リダイレクトのロケーションはindexページのURLでチェックされます。play testでテストを実行するか、play ~testであればコードの変更のタイミングでテストが実行されています。</p>

<h2 id="jsonbar">JSONとしてBarを取得する</h2>

<p>JSONのシリアライズされたデータとして全てのBarオブジェクトをアプリケーションへ返却するRESTfulなサービスを追加しましょう。app/controllers/Application.scalaファイルに新しいメソッドを追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">  def getBars <span class="o">=</span> Action <span class="o">{</span>
    val json <span class="o">=</span> inTransaction <span class="o">{</span>
      val bars <span class="o">=</span> from<span class="o">(</span>AppDB.barTable<span class="o">)(</span>barTable <span class="o">=</span>&gt;
        <span class="k">select</span><span class="o">(</span>barTable<span class="o">)</span>
      <span class="o">)</span>
      Json.generate<span class="o">(</span>bars<span class="o">)</span>
    <span class="o">}</span>
    Ok<span class="o">(</span>json<span class="o">)</span>.as<span class="o">(</span>JSON<span class="o">)</span>
  <span class="o">}</span></code></pre></figure>

<p>getBarsメソッドは、Squerylを使用してデータベースからBarオブジェクトを取ってきて、BarオブジェクトのJSON形式のリストを生成し、JSONデータを返却します。</p>

<p>conf/routesファイルに新しいルートを追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">GET     /bars                       controllers.Application.getBars</code></pre></figure>

<p>これにより、/barsへのGETリクエストがgetBarsメソッドへマッピングされます。</p>

<p>ブラウザでhttp://localhost:9000/barsを表示させ確認してみましょう。</p>

<p>JSONとしてシリアライズされたBarオブジェクトのリストが見られるはずです。</p>

<p>前述した通り、トランザクションはSquerylのinTransactionで明示的に開始される必要があり、データベースから値をselectする場合もです。そして、トランザクション内で、Barの全てののエンティティはデータベースから取得されます。</p>

<p>クエリーの構文は、Squerylのタイプ・セーフなクエリー言語の力とDSLを作るためのScalaの力を示しています。from関数は最初のパラメータとしてテーブルへのタイプ・セーフな参照を受け取ります。これはキーワードからのSQLに似ています。２番目のパラメータは、パラメータとしてクエリーにテーブルを取得し、そのテーブル上に何をするかを指定します。この場合はselectです。formは、barsを不変な定数にセットされている反復処理可能なオブジェクトを返却します。その後、Json.generateメソッドは、データベースから取得されたbarsを反復処理し、それらを返却します。jsonの定数は、application/json(JSONの値)にセットされたコンテントタイプと共に、OK(HTTP 200ステータスコードの応答)で返却されます。</p>

<h2 id="json">JSONサービスをテストする</h2>

<p>JSONサービスをテストする新しいテストのためにtest/ApplicationSpec.scalaを更新します。以下を追記します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="s2">"A request to the getBars Action"</span> should <span class="s2">"respond with data"</span> <span class="k">in</span> <span class="o">{</span>
    running<span class="o">(</span>FakeApplication<span class="o">(</span>additionalConfiguration <span class="o">=</span> inMemoryDatabase<span class="o">()))</span> <span class="o">{</span>
      inTransaction<span class="o">(</span>AppDB.barTable insert Bar<span class="o">(</span>Some<span class="o">(</span><span class="s2">"foo"</span><span class="o">)))</span>

      val result <span class="o">=</span> controllers.Application.getBars<span class="o">(</span>FakeRequest<span class="o">())</span>
      status<span class="o">(</span>result<span class="o">)</span> should equal <span class="o">(</span>OK<span class="o">)</span>
      contentAsString<span class="o">(</span>result<span class="o">)</span> should include <span class="o">(</span><span class="s2">"foo"</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span></code></pre></figure>

<p>再びこの機能テストでは、FakeApplicationとインメモリデータベースを使用します。そしてデータベースに新しいBarを生成し、Application controllerのgetBarsメソッドへのリクエストを作ります。テストしたレスポンスはOK(HTTP 200)で、生成されたBarの名前を含んでいるはずです。前と同じように、play testでこのテストを実行するか、play ~testで実行します。これで３つのテストに通っているはずです。</p>

<h2 id="coffescriptjquerybars">CoffeScriptとjQueryでBarsを表示する</h2>

<p>これで、Barオブジェクトのリストを取得するRESTfulなJSONサービスができたので、取得とindexページへの表示を行うようCoffeScriptとjQueryを使って書いてみましょう。Play2の新しい機能の一つに、CoffeeScriptからJavaScriptへコンパイルとJavaScriptの構文チェック、ミニファイ化、LESSのCSSへのコンパイルを行うassetコンパイラがあります。</p>

<p>app/assets/javascripts/index.coffeeファイルを新規作成し、下記を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>-&gt;
  <span class="nv">$.</span>get <span class="s2">"/bars"</span>, <span class="o">(</span>data<span class="o">)</span> -&gt;
    <span class="nv">$.</span>each data, <span class="o">(</span>index, item<span class="o">)</span> -&gt;
      <span class="k">$(</span><span class="s2">"#bars"</span><span class="k">)</span>.append <span class="k">$(</span><span class="s2">"&lt;li&gt;"</span><span class="k">)</span>.text item.name</code></pre></figure>

<p>このCoffeeScriptは、/barsへのgetリクエストを作るためにjQueryを使用し、各barに対して反復処理を行い、barsのidと共にbarをページのエレメントに追加します。では、このスクリプトをロードするためにapp/views/index.scala.htmlテンプレートを更新し、ページにbarsエレメントを入れてみましょう。以下の記述をテンプレートのmainセクションのトップに追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"> &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"@routes.Assets.at("</span>javascripts/index.min.js<span class="s2">")"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span>&gt;&lt;/script&gt;    
    &lt;ul <span class="nv">id</span><span class="o">=</span><span class="s2">"bars"</span>&gt;&lt;/ul&gt;</code></pre></figure>

<p>スクリプトのsrcは、javascripts/index.min.jsファイルへのURLを取得するためにroutes.Assets.at関数を使うことに注意してください。まだこのファイルは存在していません。Playのassetコンパイラは、index.coffeeファイルをコンパイルしてミニファイ化されたこのファイルを生成する必要がることを検知します。再度http://localhost:9000 のWebページを読み込み、新しいBarを生成し、Webページに表示されることを確認しましょう。</p>

<h2 id="heroku">Herokuへのデプロイ</h2>

<p>Herokuはクラウド上でPlay2の実行環境を提供する複数言語対応したCloud Application Platformです。このアプリケーションをHerokuへデプロイするには以下の手順を実行します。</p>

<p><em>1. 下記の内容を記述したProcfileをルートディレクトリは以下に作成します。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">web: target/start -Dhttp.port<span class="o">=</span><span class="k">${</span><span class="nv">PORT</span><span class="k">}</span> -DapplyEvolutions.default<span class="o">=</span><span class="nb">true</span> -Ddb.default.driver<span class="o">=</span>org.postgresql.Driver -Ddb.default.url<span class="o">=</span><span class="k">${</span><span class="nv">DATABASE_URL</span><span class="k">}</span> <span class="k">${</span><span class="nv">JAVA_OPTS</span><span class="k">}</span></code></pre></figure>

<p>これによりHerokuへPlayアプリケーションの実行方法を伝えます。</p>

<p><em>2. Herokuは、Heroku上へのファイル転送にGitを用います。まだGitがインストールされていないのであれば、Gitをインストールしましょう。プロジェクトのルートディレクトリから、このプロジェクト用のGitリポジトリを生成し、ファイルを追加し、コミットします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">git init
git add .
git commit -m init</code></pre></figure>

<p><em>3. HerokuのツールベルトはHerokuへのコマンドラインインターフェースです。Heroku ツールベルトをインストールしましょう。</em></p>

<p><em>4. Herokuアカウントへサインアップします。</em></p>

<p><em>5. コマンドラインからHerokuへログインします：</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku login</code></pre></figure>

<p>GitのSSHキーをセットアップし、それをHerokuアカウントへ紐付けます。</p>

<p><em>6. 新しいアプリケーションをHerokuにプロビジョニングします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku create --stack cedar</code></pre></figure>

<p><em>7. HerokuへアプリケーションをPushします。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">git push heroku master</code></pre></figure>

<p>Herokuが、SBTでアプリケーションをビルドし、dyno上で実行します。</p>

<p><em>8. ブラウザでクラウド上で実行されるアプリケーションを開きましょう。</em></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku open</code></pre></figure>

<p>おめでとうございます！これであなたのアプリケーションはクラウド上で実行されています。</p>

<h2 id="share-your-opinion">Share Your Opinion</h2>

<p>Play2について思うところはありませんか？<a href="http://www.artima.com/forums/flat.jsp?forum=226&amp;thread=344288">Getting Started with Play2, Scala, and Squeryl</a>のフォーラムトピックで議論しましょう。</p>

<h2 id="section-2">リソース</h2>

<p>このプロジェクトの全てのソースコードは、Github上から入手することができます。</p>

<p><a href="https://github.com/jamesward/play2bars/blob/scala-squeryl">https://github.com/jamesward/play2bars/blob/scala-squeryl</a></p>

<p>ローカルでPlayが実行されている場合、Playのローカルドキュメントにアクセスできます。</p>

<p><a href="http://localhost:9000/@documentation">http://localhost:9000/@documentation</a></p>

<p>下記のサイトでもPlayのドキュメントを閲覧できます。</p>

<p><a href="http://www.playframework.org/documentation">http://www.playframework.org/documentation</a></p>

<p>Herokuについては、Heroku Dev Centerを見てください。</p>

<p><a href="http://devcenter.heroku.com/">http://devcenter.heroku.com/</a></p>

<p>この記事が一助となればと思いますが、もし質問や問題があれば我々に知らせてください。</p>

<h2 id="section-3">著者について</h2>

<p>James Ward (<a href="www.jamesward.com">www.jamesward.com</a>) is a Principal Developer Evangelist at Heroku. Today he focuses on teaching developers how to deploy Java, Play! and Scala apps to the cloud. James frequently presents at conferences around the world such as JavaOne, Devoxx, and many other Java get-togethers. Along with Bruce Eckel, James co-authored First Steps in Flex. He has also published numerous screencasts, blogs, and technical articles. Starting with Pascal and Assembly in the 80’s, James found his passion for writing code. Beginning in the 90’s he began doing web development with HTML, Perl/CGI, then Java. After building a Flex and Java based customer service portal in 2004 for Pillar Data Systems he became a Technical Evangelist for Flex at Adobe. You can find him tweeting as <a href="http://twitter.com/_JamesWard">@JamesWard</a>, answering questions on <a href="http://stackoverflow.com/users/77409/james-ward">StackOverflow.com</a>, and posting code at <a href="http://github.com/jamesward">github.com/jamesward</a>.</p>

<p>Ryan Knight is a senior software architect and consultant with over fifteen years of experience in all aspects of cloud computing and software development. He first started Java Consulting for Sun Microsystems Java Center and now runs his own consulting company. Some of his recent projects include being a software Consultant for Deloitte at the State of Louisiana, expert services for Adobe at T-Mobile, creatng a web application at Team Marketing Report, development of a text and voice chat system for Sony Online Entertainment, contributing to the Development of a Gift Card Creation Tool, and being a software architect for Williams Pipeline.</p>


    </div>
    <div class="footer">
      <span class="social-button">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://modalsoul.github.io/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html/" data-via="modal_soul" data-lang="ja">ツイート</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <a href="http://b.hatena.ne.jp/entry/modalsoul.github.io/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html" class="hatena-bookmark-button" data-hatena-bookmark-title="【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
    <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
  </a>
  <div class="fb-like" data-href="http://modalsoul.github.io/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>

  <!-- このタグを +1 ボタンを表示する場所に挿入してください -->
  <g:plusone size="medium"></g:plusone>

</span>

    </div>
    <div class="post-paginator">
      
      <span class="next label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/08/10/Sign-in-with-Facebook-Scala.html" aria-label="Next">
          <span aria-hidden="true">&laquo;【意訳】Scala on LiftでのFacebookサインイン</span>
        </a>
      </span>
      
      
      <span class="previous label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html" aria-label="Previous">
          <span aria-hidden="true">【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja&raquo;</span>
        </a>
      </span>
      
    </div>
    <div id="disqus_thread">
  <a href="http://modalsoul.github.io#disqus_thread">Link</a>
</div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = http://modalsoul.github.io; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//modalsoul.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </span>
  <span class="right-navi col-md-3 col-lg-3">
    <h3>Latest post:</h3>
    <ul class="post-list">
      
        <li><a href="/programming/2017/02/02/openwhisk-scala-sbt-giter8-template.html">OpenWhiskのScala sbtプロジェクトのgiter8テンプレートを作った</a></li>
      
        <li><a href="/programming/2017/01/24/serverless-architecture-starting-with-openwhisk-and-scala.html">OpenWhisk+Scalaで作るServerless Architectureとっかかり</a></li>
      
        <li><a href="/programming/2017/01/22/deploy-playframework-application-to-bluemix.html">BluemixにPlayframeworkアプリケーションをデプロイする</a></li>
      
        <li><a href="/programming/2017/01/20/giter8-sbt-new-integration.html">sbt、Giter8を統合するってよ</a></li>
      
        <li><a href="/programming/2016/11/10/scala-sam-type.html">Scala 2.12.0でSAM型</a></li>
      
    </ul>
    <h3>Recent Books:</h3>
    <ul class="books-list">
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=427421933X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22" target="_blank">
      新装版 達人プログラマー 職人から名匠への道
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4798046140&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22" target="_blank">
      プリンシプル オブ プログラミング3年目までに身につけたい一生役立つ101の原理原則
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4844381490&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22" target="_blank">
      Scalaスケーラブルプログラミング第3版
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4822251551&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22" target="_blank">
      SOFT SKILLS ソフトウェア開発者の人生マニュアル
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=487311750X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22" target="_blank">
      Sparkによる実践データ解析 ―大規模データのための機械学習事例集
    </a>
  </div>
</div>

</li>
      
    </ul>
  </span>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
)</li>

  <li><a href="/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html">【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja</a> (26 Jul 2012 | Tags: <!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja</title>
  <meta name="description" content="この記事は、HerokuのPrincipal Developer EvangelistのJames Ward氏の記事の意訳です。参考程度にどうぞ。">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <span class="col-md-9 col-lg-9">
    <header class="post-header">
      <time datetime="2012-07-26T00:00:00+09:00" itemprop="datePublished">Jul 26, 2012</time>
      <h1 class="post-title" itemprop="name headline">【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja</h1>
      <div class="post-meta">
        <span class="tags-icon glyphicon glyphicon-folder-open" aria-hidden="true"></span>
        
          <a href="/programing" class="label label-default">Programing</a>
        
        <span class="tags-icon glyphicon glyphicon-tags" aria-hidden="true"></span>
        
          <a href="/tag/play2" class="label label-default">Play2</a>
        
          <a href="/tag/heroku" class="label label-default">Heroku</a>
        
          <a href="/tag/database-driven" class="label label-default">Database-Driven</a>
        
          <a href="/tag/akka" class="label label-default">Akka</a>
        
      </div>
    </header>
    

    <div class="post-content" itemprop="articleBody">
      <p>この記事は、HerokuのPrincipal Developer Evangelistの<a href="http://www.jamesward.com/2012/06/25/optimizing-play-2-for-database-driven-apps">James Ward氏の記事</a>の意訳です。参考程度にどうぞ。</p>

<p><img src="http://capture.heartrails.com/300x200/cool?http://www.jamesward.com/2012/06/25/optimizing-play-2-for-database-driven-apps" alt="Optimizing Play 2 for Database-Driven Apps" /></p>

<p>誤訳・誤植等ありましたら、<a href="https://twitter.com/modal_soul">@modal_soulまで</a>リプライいただけるとありがたいです。</p>

<hr />

<p>先週Matt Raible氏と共に、UberConfで行われたPlay vs. Grailsスマックダウンでプレゼンテーションをしました。
このセッションの目標は、同じフレームワークを用いて同じアプリケーションを作り、Play2+JavaとGrailsを比較することです。
比較のために、いくつかのベンチマークを含む評価基準を使用しました。
結果については、こちら（<a href="http://raibledesigns.com/rd/entry/play_vs_grails_smackdown_at">Matt’s session recap blog</a>）に詳しく掲載されています。
評価結果のプレゼンの後、これらのタイプのアプリケーションでPlay2のAkkaスレッドシステムを最適化するのに重要なことを発見しました。
Play2は、ブロッキングのコールを含まないHTTPリクエスト(i.e. 非同期)のためにout-of-the-boxに最適化されています。
Javaのほとんどのデータベース駆動アプリでは同期コールはJDBC経由で使用されるため、Play2ではこれらのリクエストタイプのためにAkkaを調整するちょっとした設定が必要です。</p>

<p>シンプルな例をあげてみます。時間的に現実的なデータベースブロックをシミュレートするために、このベンチマークをローカルではなくHeroku上で実行します。
<a href="https://github.com/jamesward/play2bars">“play2bars”example app</a>から”java-ebean”ブランチとHerokuの共有のPostgreSQLデータベースを使います。</p>

<p>Apache Benchを実行して、同時100クライアント接続で10000リクエストをアプリのJSONサービスへ投げるために、同じAWSリージョンにあるEC2サーバーからHerokuのmy appとして、以下のコマンドを実行しました。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">ab -n 10000 -c 100 http://falling-dusk-7291.herokuapp.com/bars</code></pre></figure>

<p>最初の最適化前の結果がこちらです</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">Concurrency Level:      100
Time taken <span class="k">for </span>tests:   10.272 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Total transferred:      1560000 bytes
HTML transferred:       510000 bytes
Requests per second:    973.53 <span class="o">[</span><span class="c">#/sec] (mean)</span>
Time per request:       102.719 <span class="o">[</span>ms] <span class="o">(</span>mean<span class="o">)</span></code></pre></figure>

<p>毎秒973リクエストは悪くはありませんが、下記のようなエラーが確認できました。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="o">[</span>error] play - Cannot invoke the action, eventually got an error: Thrown<span class="o">(</span>akka.pattern.AskTimeoutException: Timed out<span class="o">)</span></code></pre></figure>

<p>これは、Akkaが長時間ブロックされたことを意味しており、同期のコード実行を改善するようにPlay中のAkkaの設定を変え、評価を再実行しました。その結果は以下のようになりました。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">Concurrency Level:      100
Time taken <span class="k">for </span>tests:   7.274 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Total transferred:      1560000 bytes
HTML transferred:       510000 bytes
Requests per second:    1374.70 <span class="o">[</span><span class="c">#/sec] (mean)</span>
Time per request:       72.743 <span class="o">[</span>ms] <span class="o">(</span>mean<span class="o">)</span></code></pre></figure>

<p>今回は、毎秒1374リクエストになりました。シンプルな最適化の方法は、Akkaで処理を行うスレッドを増やすして、タイムアウト値を長く設定することです。それによりスレッドが同期DBによってブロックされた際、より多くのリクエストをハンドリングするためにさらにスレッドを呼び出します。実際に使ったPlayの設定は以下です。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">play <span class="o">{</span>
 
    akka <span class="o">{</span>
 
        actor <span class="o">{</span>
 
            deployment <span class="o">{</span>
 
                /actions <span class="o">{</span>
                    router <span class="o">=</span> round-robin
                    nr-of-instances <span class="o">=</span> 100
                <span class="o">}</span>
 
                /promises <span class="o">{</span>
                    router <span class="o">=</span> round-robin
                    nr-of-instances <span class="o">=</span> 100
                <span class="o">}</span>
 
            <span class="o">}</span>
 
            retrieveBodyParserTimeout <span class="o">=</span> 5 seconds
 
            actions-dispatcher <span class="o">=</span> <span class="o">{</span>
                fork-join-executor <span class="o">{</span>
                    parallelism-factor <span class="o">=</span> 100
                    parallelism-max <span class="o">=</span> 100
                <span class="o">}</span>
            <span class="o">}</span>
 
            promises-dispatcher <span class="o">=</span> <span class="o">{</span>
                fork-join-executor <span class="o">{</span>
                    parallelism-factor <span class="o">=</span> 100
                    parallelism-max <span class="o">=</span> 100
                <span class="o">}</span>
            <span class="o">}</span>
 
        <span class="o">}</span>
 
    <span class="o">}</span>
 
<span class="o">}</span></code></pre></figure>

<p>Akkaで使用されるスレッドの数は、CPUと”parallelism-factor”の設定値を掛け合わせた値で、”parallelism-max”が上限値です。
デフォルトの”parallelism-factor”は”1”に設定されていて、この場合スレッド数はCPU数と同じで、”parallelism-max”のデフォルトは”24”です。これらの設定について詳しくは、<a href="http://www.playframework.org/documentation/2.0/AkkaCore">Playのドキュメント</a>で確認できます。</p>

<p>すべての設定ファイルは<a href="https://github.com/jamesward/play2bars/tree/java-ebean/conf">こちらのplay2barsプロジェクトから</a></p>

<p>このベンチマークはあくまで参考であって、それぞれの環境で異なってくると思います。それぞれの環境に合わせたチューニングをしてください。質問があれば是非。</p>


    </div>
    <div class="footer">
      <span class="social-button">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://modalsoul.github.io/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html/" data-via="modal_soul" data-lang="ja">ツイート</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <a href="http://b.hatena.ne.jp/entry/modalsoul.github.io/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html" class="hatena-bookmark-button" data-hatena-bookmark-title="【意訳】データベース駆動アプリのための、Play2最適化について　#play_ja" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
    <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
  </a>
  <div class="fb-like" data-href="http://modalsoul.github.io/programing/2012/07/26/Optimizing-Play2-for-Database-Driven-Apps.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>

  <!-- このタグを +1 ボタンを表示する場所に挿入してください -->
  <g:plusone size="medium"></g:plusone>

</span>

    </div>
    <div class="post-paginator">
      
      <span class="next label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/07/31/Getting-Started-with-Play2-Scala-and-Squeryl.html" aria-label="Next">
          <span aria-hidden="true">&laquo;【意訳】Scala on Play2 with Squerylではじめるデータベース駆動アプリ　#scalajp　#play_ja</span>
        </a>
      </span>
      
      
      <span class="previous label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/report/programing/2012/06/02/minato-ruby-kaigi-01.html" aria-label="Previous">
          <span aria-hidden="true">みなとRuby会議01に参加しました。#minatork01&raquo;</span>
        </a>
      </span>
      
    </div>
    <div id="disqus_thread">
  <a href="http://modalsoul.github.io#disqus_thread">Link</a>
</div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = http://modalsoul.github.io; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//modalsoul.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </span>
  <span class="right-navi col-md-3 col-lg-3">
    <h3>Latest post:</h3>
    <ul class="post-list">
      
        <li><a href="/programming/2017/02/02/openwhisk-scala-sbt-giter8-template.html">OpenWhiskのScala sbtプロジェクトのgiter8テンプレートを作った</a></li>
      
        <li><a href="/programming/2017/01/24/serverless-architecture-starting-with-openwhisk-and-scala.html">OpenWhisk+Scalaで作るServerless Architectureとっかかり</a></li>
      
        <li><a href="/programming/2017/01/22/deploy-playframework-application-to-bluemix.html">BluemixにPlayframeworkアプリケーションをデプロイする</a></li>
      
        <li><a href="/programming/2017/01/20/giter8-sbt-new-integration.html">sbt、Giter8を統合するってよ</a></li>
      
        <li><a href="/programming/2016/11/10/scala-sam-type.html">Scala 2.12.0でSAM型</a></li>
      
    </ul>
    <h3>Recent Books:</h3>
    <ul class="books-list">
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=427421933X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22" target="_blank">
      新装版 達人プログラマー 職人から名匠への道
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4798046140&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22" target="_blank">
      プリンシプル オブ プログラミング3年目までに身につけたい一生役立つ101の原理原則
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4844381490&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22" target="_blank">
      Scalaスケーラブルプログラミング第3版
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4822251551&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22" target="_blank">
      SOFT SKILLS ソフトウェア開発者の人生マニュアル
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=487311750X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22" target="_blank">
      Sparkによる実践データ解析 ―大規模データのための機械学習事例集
    </a>
  </div>
</div>

</li>
      
    </ul>
  </span>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
)</li>

  <li><a href="/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html">【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］</a> (04 Mar 2012 | Tags: <!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］</title>
  <meta name="description" content="元記事はこちら">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <span class="col-md-9 col-lg-9">
    <header class="post-header">
      <time datetime="2012-03-04T00:00:00+09:00" itemprop="datePublished">Mar 4, 2012</time>
      <h1 class="post-title" itemprop="name headline">【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］</h1>
      <div class="post-meta">
        <span class="tags-icon glyphicon glyphicon-folder-open" aria-hidden="true"></span>
        
          <a href="/programing" class="label label-default">Programing</a>
        
        <span class="tags-icon glyphicon glyphicon-tags" aria-hidden="true"></span>
        
          <a href="/tag/play2" class="label label-default">Play2</a>
        
          <a href="/tag/scala" class="label label-default">Scala</a>
        
          <a href="/tag/coffeescript" class="label label-default">CoffeeScript</a>
        
          <a href="/tag/jquery" class="label label-default">jQuery</a>
        
          <a href="/tag/heroku" class="label label-default">Heroku</a>
        
          <a href="/tag/anrom" class="label label-default">Anrom</a>
        
      </div>
    </header>
    

    <div class="post-content" itemprop="articleBody">
      <p>元記事は<a href="http://www.jamesward.com/2012/02/21/play-framework-2-with-scala-anorm-json-coffeescript-jquery-heroku">こちら</a></p>

<p>少々長い記事なので、Play2アプリのビルド編とHerokuへのデプロイ編に分けます。</p>

<p>今回は、Herokuへのデプロイ編です。</p>

<p>Play2アプリのビルド編は、<a href="http://modalsoul.github.com/Programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku/">こちら</a></p>

<p><img src="http://capture.heartrails.com/200x150/cool?http://modalsoul.github.com/Programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku/" alt="Play2アプリビルド編" /></p>
<hr />

<p>Step 1) <a href="http://heroku.com/signup">Herokuのアカウントを取得</a>して、<a href="http://toolbelt.heroku.com/">Heroku Toolbelt</a>と<a href="http://git-scm.org/">git</a>をインストールして、コマンドラインからHerokuへログインします</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>heroku login</code></pre></figure>

<p>もしこれがはじめてのHerokuへのログインだったら、git用のSSHキーの作成と、Herokuアカウントへの紐付けをする必要があります。</p>

<p>Step 2) Heroku上の各アプリケーションは、テスト用にPostgres DBを持っています。
Heroku上でアプリケーションを実行してこのDBを使うには、別途設定が必要です。
これにはいくつか方法がありますが、最も簡単な方法はスタートアップコマンドラインからDBの設定をオーバーライドする方法です。
これはStep3で紹介します。
その前に、Psotgres JDBCドライバーをプロジェクトの依存関係として指定する必要があります。
“project/Build.scala”ファイルに、以下のような”appDependencies”を設定します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">   val appDependencies <span class="o">=</span> Seq<span class="o">(</span>
      <span class="s2">"postgresql"</span> % <span class="s2">"postgresql"</span> % <span class="s2">"9.1-901-1.jdbc4"</span>
    <span class="o">)</span></code></pre></figure>

<p>Step 3) Herokuにどのプロセスを実行するのかを教えるために、プロジェクトルートディレクトリ配下にファイル名”Procfile”を作成し（※大文字と小文字が区別されます）、以下のように記述します</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">web: target/start -Dhttp.port<span class="o">=</span><span class="nv">$PORT</span> -DapplyEvolutions.default<span class="o">=</span><span class="nb">true</span> -Ddb.default.driver<span class="o">=</span>org.postgresql.Driver -Ddb.default.url<span class="o">=</span><span class="nv">$DATABASE_URL</span></code></pre></figure>

<p>Play2では、プロジェクトのビルドにScala Build Tool(SBT)を使います。プロジェクトがHerokuへデプロイされると、プロジェクトをコンパイルするため”sbt stage!コマンドが実行されます。
そして、プロセスがJavaのクラスパスの設定とPlayサーバーの起動をする”taget/start”スクリプトを生成します。
Herokuはアプリケーションに、Javaプロパティ”http.port”が適宜設定されるように、環境変数”PORT”を使用してリッスンすべきHTTPポートを通知します。
また、Heroku上のアプリケーションへDB（とその他のリソース）への接続文字列は、デフォルトでは環境変数介して渡されます。
環境変数のDATABASE_URLは、DBホスト、名前、ユーザ名、パスワードを含みます。
所謂”db.default.url”プロパティがその値で設定されます。
またドライバは、Postgres JDBCドライバクラスに設定されます。</p>

<p>Step 4) Herokuはアプリケーションのアップロード方法としてgitを使っています。
SCMツールにgitを使っていようと無かろうとHerokuへアプリケーションをアップロードするにはgitを使います。
プロジェクトのルートディレクトリでgit repoを作り、ファイルを追加してコミットします。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">	git init
	git add Procfile app conf project public
	git commit -m init</code></pre></figure>

<p>※ 選択しての”git add”の代わりに、”.gitignore”ファイルを更新することもできます。</p>

<p>Step 5) Heroku CLIを使用して、Heroku上に新しいアプリケーションをプロビジョニングします。
あなたが作った各アプリケーションは1月辺り、750<a href="http://devcenter.heroku.com/articles/dynos">“dyno”</a>時間無料です。
開発者として無料でHerokuを使用でき、スケールした分だけ支払うことになります。
コマンドライン上で、”cedar”スタックを使って新しいアプリケーションを作ります。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku create -s cedar</code></pre></figure>

<p>これでアプリケーションのHTTPとgitのエンドポイントを作ります。
アプリケーションで変更した名前を使うことも、自身のドメイン名を使うことも可能です。</p>

<p>Step 6) アプリケーションはクラウドへデプロイする準備が整いました。コマンドラインからHerokuのマスターブランチへ”git push”します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">git push heroku master</code></pre></figure>

<p>Herokuがファイル受け取ると、Play Frameworkのプレコンパイラが実行され、Herokuが”slug file”をアセンブルし、”slug”がdynoへデプロイされます。</p>

<p>Step 7) これで”heroku create”に続いて出力のドメインに移動する、もしくは単純に実行することで、ブラウザでアプリケーションを表示できます。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">heroku open</code></pre></figure>

<p>Scala, Anorm, JSON, CoffeeScript, jQueryを使ったPlay2アプリケーションをHeroku上にデプロイできたはずです。
これよりも詳細にHerokuの使い方を知りたいときは、<a href="http://devcenter.heroku.com/">Heroku Dev Center</a>を確認してください。
もし質問があったら、私に知らせてください。</p>

<p>このエントリーは、CoffeeScript, jQuery, Play Framework, Scalaを使ってポストされました。パーマリンクをブックマークしてください。コメントかトラックバックをよろしく。トラックバックURLは、<a href="http://www.jamesward.com/2012/02/21/play-framework-2-with-scala-anorm-json-coffeescript-jquery-heroku/trackback/">こちら</a></p>


    </div>
    <div class="footer">
      <span class="social-button">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://modalsoul.github.io/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html/" data-via="modal_soul" data-lang="ja">ツイート</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <a href="http://b.hatena.ne.jp/entry/modalsoul.github.io/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html" class="hatena-bookmark-button" data-hatena-bookmark-title="【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
    <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
  </a>
  <div class="fb-like" data-href="http://modalsoul.github.io/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>

  <!-- このタグを +1 ボタンを表示する場所に挿入してください -->
  <g:plusone size="medium"></g:plusone>

</span>

    </div>
    <div class="post-paginator">
      
      <span class="next label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/report/2012/03/14/AgileUx-NYC-2012-Redux-in-Tokyo.html" aria-label="Next">
          <span aria-hidden="true">&laquo;AgileUX NYC 2012 Redux in Tokyo(#AgileUXNYC_ja)に参加しました。</span>
        </a>
      </span>
      
      
      <span class="previous label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html" aria-label="Previous">
          <span aria-hidden="true">【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&Heroku ［Play2アプリのビルド編］&raquo;</span>
        </a>
      </span>
      
    </div>
    <div id="disqus_thread">
  <a href="http://modalsoul.github.io#disqus_thread">Link</a>
</div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = http://modalsoul.github.io; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//modalsoul.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </span>
  <span class="right-navi col-md-3 col-lg-3">
    <h3>Latest post:</h3>
    <ul class="post-list">
      
        <li><a href="/programming/2017/02/02/openwhisk-scala-sbt-giter8-template.html">OpenWhiskのScala sbtプロジェクトのgiter8テンプレートを作った</a></li>
      
        <li><a href="/programming/2017/01/24/serverless-architecture-starting-with-openwhisk-and-scala.html">OpenWhisk+Scalaで作るServerless Architectureとっかかり</a></li>
      
        <li><a href="/programming/2017/01/22/deploy-playframework-application-to-bluemix.html">BluemixにPlayframeworkアプリケーションをデプロイする</a></li>
      
        <li><a href="/programming/2017/01/20/giter8-sbt-new-integration.html">sbt、Giter8を統合するってよ</a></li>
      
        <li><a href="/programming/2016/11/10/scala-sam-type.html">Scala 2.12.0でSAM型</a></li>
      
    </ul>
    <h3>Recent Books:</h3>
    <ul class="books-list">
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=427421933X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22" target="_blank">
      新装版 達人プログラマー 職人から名匠への道
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4798046140&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22" target="_blank">
      プリンシプル オブ プログラミング3年目までに身につけたい一生役立つ101の原理原則
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4844381490&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22" target="_blank">
      Scalaスケーラブルプログラミング第3版
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4822251551&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22" target="_blank">
      SOFT SKILLS ソフトウェア開発者の人生マニュアル
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=487311750X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22" target="_blank">
      Sparkによる実践データ解析 ―大規模データのための機械学習事例集
    </a>
  </div>
</div>

</li>
      
    </ul>
  </span>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
)</li>

  <li><a href="/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html">【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&Heroku ［Play2アプリのビルド編］</a> (29 Feb 2012 | Tags: <!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&amp;Heroku ［Play2アプリのビルド編］</title>
  <meta name="description" content="元記事はこちら">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://modalsoul.github.io/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html">
  <link rel="alternate" type="application/rss+xml" title="modal_soul debriefing" href="http://modalsoul.github.io/feed.xml">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Bootstrap CDN JS -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <meta property="og:title" content="【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&Heroku ［Play2アプリのビルド編］">
<meta property="og:type" content="article">
<meta property="og:url" content="http://modalsoul.github.io/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html">
<meta property="og:site_name" content="modal_soul debriefing">
<meta property="og:description" content="I guess you could call it a failure, but I prefer the term learning experience.">
<meta property="og:image" content="http://c1.staticflickr.com/5/4033/4654970063_80a0bfe2c8_n.jpg">


  <div id="fb-root"></div>
  <script>(function(d, s, id) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.5&appId=1426778114318648";
  	fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
  <!-- この render 呼び出しを適切な位置に挿入してください -->
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};

    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">modal_soul debriefing<img src="/img/logo.png" style="margin-left:0.2em;"/></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!-- 
          
          <a class="page-link" href="/404.html">404</a>
          
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/books/">Book</a>
          
        
          
          <a class="page-link" href="/categories/">Category</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/tags/">Tag</a>
          
        
          
          <a class="page-link" href="/record/index.html">Category archive for record</a>
          
        
          
          <a class="page-link" href="/Programing/index.html">Category archive for Programing</a>
          
        
          
          <a class="page-link" href="/CI/index.html">Category archive for CI</a>
          
        
          
          <a class="page-link" href="/Environment/index.html">Category archive for Environment</a>
          
        
          
          <a class="page-link" href="/report/index.html">Category archive for report</a>
          
        
          
          <a class="page-link" href="/Test/index.html">Category archive for Test</a>
          
        
          
          <a class="page-link" href="/environment/index.html">Category archive for environment</a>
          
        
          
          <a class="page-link" href="/programing/index.html">Category archive for programing</a>
          
        
          
          <a class="page-link" href="/poem/index.html">Category archive for poem</a>
          
        
          
          <a class="page-link" href="/booklog/index.html">Category archive for booklog</a>
          
        
          
          <a class="page-link" href="/gadget/index.html">Category archive for gadget</a>
          
        
          
          <a class="page-link" href="/programming/index.html">Category archive for programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
        <a class="page-link" href="/books/">Book</a>
        <a class="page-link" href="/categories/">Category</a>
        <a class="page-link" href="/tags/">Tag</a>
        <a class="page-link" href="/about/">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <span class="col-md-9 col-lg-9">
    <header class="post-header">
      <time datetime="2012-02-29T00:00:00+09:00" itemprop="datePublished">Feb 29, 2012</time>
      <h1 class="post-title" itemprop="name headline">【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&Heroku ［Play2アプリのビルド編］</h1>
      <div class="post-meta">
        <span class="tags-icon glyphicon glyphicon-folder-open" aria-hidden="true"></span>
        
          <a href="/programing" class="label label-default">Programing</a>
        
        <span class="tags-icon glyphicon glyphicon-tags" aria-hidden="true"></span>
        
          <a href="/tag/play2" class="label label-default">Play2</a>
        
          <a href="/tag/scala" class="label label-default">Scala</a>
        
          <a href="/tag/coffeescript" class="label label-default">CoffeeScript</a>
        
          <a href="/tag/jquery" class="label label-default">jQuery</a>
        
          <a href="/tag/heroku" class="label label-default">Heroku</a>
        
          <a href="/tag/anormedit" class="label label-default">AnormEdit</a>
        
      </div>
    </header>
    

    <div class="post-content" itemprop="articleBody">
      <p>元記事は<a href="http://www.jamesward.com/2012/02/21/play-framework-2-with-scala-anorm-json-coffeescript-jquery-heroku">こちら</a></p>

<p>少々長い記事なので、Play2アプリのビルド編とHerokuへのデプロイ編に分けます。</p>

<p>今回は、Play2アプリのビルド編です。</p>

<p>Herokuへのデプロイ編は、<a href="http://modalsoul.github.com/Programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku/">こちら</a></p>

<p><img src="http://capture.heartrails.com/200x150/cool?http://modalsoul.github.com/Programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku/" alt="Herokuへのデプロイ編" /></p>

<p>※ 2012/03/06:アドバイスいただいた箇所について修正しました。</p>

<hr />

<p>Play Framework2 RC2がリリースされ、モダンなWebアプリケーションを構築する手法として成熟した生産的な方法になっています。</p>

<p>Play2とScala,Anorm,JSON,CoffeeScript,jQueryを使って迅速なアプリケーション構築を体験してみましょう。</p>

<p>一度ローカルでアプリケーションが動いてしまえば、あとはHerokuにデプロイするだけです。</p>

<p>（注意：これは<a href="http://www.jamesward.com/2011/12/11/tutorial-play-framework-jpa-json-jquery-heroku">my Play1+Java turtorial</a>の、Play2＋Scala版です。）Githubからソースを入手してください。</p>

<p>Step 1) Play2 RC2版をダウンロード・インストールしてください。</p>

<p>Step 2) 新しいアプリケーションを作ります：</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>play new foobar</code></pre></figure>

<p>プロンプトの言語選択画面がでたら、Scalaを選択してください。</p>

<p>Step 3) 新しく作成した”foobar”ディレクトリ配下にIDEの設定ファイルを生成します。</p>

<p>IntelliJでは、このように実行します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>play new foobar</code></pre></figure>

<p>注意：ここで生成されたIMLファイルは、プロジェクトとして直接インポート可能ではありません。代わりに、モジュールなしでプロジェクトを新たに生成して、このステップで生成したIMLファイルからそのプロジェクトへモジュールをインポートする必要があります。もしわからなければ、<a href="http://www.jamesward.com/2011/07/28/setup-play-framework-with-scala-in-intellij">Play1+Scala IntelliJ article</a>が参考になります。</p>

<p>Eclipseプロジェクト化するために、下記のコマンドを実行</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>play eclipsify</code></pre></figure>

<p>Step 4) Playサーバの起動</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>play run</code></pre></figure>

<p>正常に起動していることをテストするために、ここにアクセス<a href="http://localhost:9000">http://localhost:9000</a></p>

<p>Step 5) Play2 with ScalaではデフォルトでORマッパーを提供していません。代わりにデフォルトのRDBMS永続性プロバイダとなっているのがAnormです(Anormは Object Relational Mapperではありません)。このシンプルなアプリケーションでは、1つの永続的オブジェクト：Bar(ひとつのプライマリキーと名前を持っている)を持っています。Anormは、自動でのスキーマ作成を行わないので、SQLスキーマの作成/廃棄のためのスクリプトが必要です。新しいファイル”conf/evolutions/default/1.sql”を作成し、以下の内容を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="c"># --- First database schema</span>
 
<span class="c"># --- !Ups</span>
 
CREATE TABLE bar <span class="o">(</span>
  id                        SERIAL PRIMARY KEY,
  name                      VARCHAR<span class="o">(</span>255<span class="o">)</span> NOT NULL
<span class="o">)</span>;
 
<span class="c"># --- !Downs</span>
 
DROP TABLE IF EXISTS bar;</code></pre></figure>

<p>Anormでは、Scalaの”case class”を永続的/CRUDインターフェースとして、値オブジェクトとシングルトンオブジェクトとして扱うことができます。”app/models/Bar.scla”というファイルにBar case classとオブジェクトを作成して、以下の内容を記述します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package models
 
import play.api.db._
import play.api.Play.current
 
import anorm._
import anorm.SqlParser._
 
<span class="k">case</span> class Bar<span class="o">(</span>id: Pk[Long], name: String<span class="p">)</span>
 
object Bar <span class="o">{</span>
 
  val simple <span class="o">=</span> <span class="o">{</span>
    get[Pk[Long]]（<span class="s2">"id"</span><span class="o">)</span> ~
    get[String]（<span class="s2">"name"</span><span class="o">)</span> map <span class="o">{</span>
      <span class="k">case</span> id~name <span class="o">=</span>&gt; Bar<span class="o">(</span>id, name<span class="p">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
 
  def findAll<span class="o">()</span>: Seq[Bar] <span class="o">=</span> <span class="o">{</span>
    DB.withConnection <span class="o">{</span> implicit connection <span class="o">=</span>&gt;
      SQL<span class="o">(</span><span class="s2">"select * from bar"</span><span class="o">)</span>.as<span class="o">(</span>Bar.simple <span class="k">*</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
 
  def create<span class="o">(</span>bar: Bar<span class="o">)</span>: Unit <span class="o">=</span> <span class="o">{</span>
    DB.withConnection <span class="o">{</span> implicit connection <span class="o">=</span>&gt;
      SQL<span class="o">(</span><span class="s2">"insert into bar(name) values ({name})"</span><span class="o">)</span>.on<span class="o">(</span>
        <span class="s1">'name -&gt; bar.name
      ).executeUpdate()
    }
  }
 
}</span></code></pre></figure>

<p>変数の”simple”は、データベースの行値をBar case classにマップする、基本的なパーサを提供します。</p>

<p>静的関数、”findAll”と”create”は、一般的なデータアクセスを行います。</p>

<p>注意点としては、”findAll”はBarへ各行を返すために、”simple” row parserを使っている点です。</p>

<p>Step 6) インメモリーのh2データベースを使うために、”conf/application.conf”ファイルに以下の値を設定する。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">db.default.driver<span class="o">=</span>org.h2.Driver
db.default.url<span class="o">=</span><span class="s2">"jdbc:h2:mem:play"</span></code></pre></figure>

<p>Step 7) “app/controllers/Application.scala”を下記のように更新し、BarをHTTP POSTへ変換してデータベースに反映するアプリケーションコントローラー関数を作成します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">package controllers
 
import play.api.data.Form
import play.api.data.Forms.<span class="o">{</span>single, nonEmptyText<span class="o">}</span>
import play.api.mvc.<span class="o">{</span>Action, Controller<span class="o">}</span>
import anorm.NotAssigned
 
import models.Bar
 
 
object Application extends Controller <span class="o">{</span>
 
  val barForm <span class="o">=</span> Form<span class="o">(</span>
    single<span class="o">(</span><span class="s2">"name"</span> -&gt; nonEmptyText<span class="o">)</span>
  <span class="o">)</span>
 
  def index <span class="o">=</span> Action <span class="o">{</span>
    Ok<span class="o">(</span>views.html.index<span class="o">(</span>barForm<span class="o">))</span>
  <span class="o">}</span>
 
  def addBar<span class="o">()</span> <span class="o">=</span> Action <span class="o">{</span> implicit request <span class="o">=</span>&gt;
    barForm.bindFromRequest.fold<span class="o">(</span>
      errors <span class="o">=</span>&gt; BadRequest,
      <span class="o">{</span>
        <span class="k">case</span> <span class="o">(</span>name<span class="p">)</span> <span class="o">=</span>&gt;
          Bar.create<span class="o">(</span>Bar<span class="o">(</span>NotAssigned, name<span class="o">))</span>
          Redirect<span class="o">(</span>routes.Application.index<span class="o">())</span>
      <span class="o">}</span>
    <span class="o">)</span>
  <span class="o">}</span>
 
<span class="o">}</span></code></pre></figure>

<p>“barForm”マップは、フォームオブジェクトへパラメータを要求し、入力データのバリデーションを行います。
静的関数の”addBar”は、リクエストと”barForm”へのリクエストパラメータのマッピングを行います。
失敗した場合は、コントローラはBadRequestを返します。
成功した場合は、Barの名前は新しい”Bar”を構築するために使われます。そしてその”Bar”はデータベースに保存され、indexページへのリダイレクトが送られます。
index関数は、Step 9で更新されるテンプレートへ”barForm”を渡すように変更されました。</p>

<p>Step 8) “conf/routes”ファイルに以下の行を追加して、”/addBar” URLへのPOSTリクエストを”Application.addBar”へマップする新しいルートを作成します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">POST	/addBar		controllers.Application.addBar</code></pre></figure>

<p>Step 9) フォームパラメータを受け取るために、”main”テンプレートを拡張した”app/views/index.scala.html”テンプレートを更新し、Webページ上のフォームをレンダリングするためにPlay2 form helperを使います。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">　＠<span class="o">(</span>form: play.api.data.Form[String]<span class="o">)</span>
 
　＠main<span class="o">(</span><span class="s2">"Welcome to Play 2.0"</span><span class="o">)</span> ｛
 
    　＠helper.form<span class="o">(</span>action <span class="o">=</span> routes.Application.addBar<span class="o">)</span> ｛
        　＠helper.inputText<span class="o">(</span>form<span class="o">(</span><span class="s2">"name"</span><span class="o">))</span>
        ＜input <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span>/＞
    ｝
 
｝</code></pre></figure>

<p>ブラウザで<a href="http://localhost:9000">http://localhost:9000</a>を開き、データベース変更の適用と、フォームのテストをします。うまくできていれば、フォームを送信するとindexページへリダイレクトされるはずです。</p>

<p>Step 10) JSONサービスを作成し、barの全てを取得するための関数を、”app/controllers/Application.scala”ファイルに追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">  import com.codahale.jerkson.Json
 
  def listBars<span class="o">()</span> <span class="o">=</span> Action <span class="o">{</span>
    val bars <span class="o">=</span> Bar.findAll<span class="o">()</span>
 
    val json <span class="o">=</span> Json.generate<span class="o">(</span>bars<span class="o">)</span>
 
    Ok<span class="o">(</span>json<span class="o">)</span>.as<span class="o">(</span><span class="s2">"application/json"</span><span class="o">)</span>
  <span class="o">}</span></code></pre></figure>

<p>新しく作成した関数は、シリアル化されたJSONとして、”Bar.findAll()”から”Bar”オブジェクトのリストを返します。</p>

<p>“/listBars”へのリクエストのために、下記のように新しいGET request handlerを”conf/routes”に追加します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">GET		/listBars		controllers.Application.listBars</code></pre></figure>

<p>ブラウザで<a href="http://localhost:9000/listBars">http://localhost:9000/listBars</a>を開いてみてください。Step 9で作成したbarが表示されているはずです。</p>

<p>Step 11) jQueryを使いJSONシリアル化されたbarの取得と、それぞれのページ追加のために、新しいCoffeeScriptファイル”app/assets/javascripts/index.coffee”を作成します。内容は以下</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>-&gt;
  <span class="nv">$.</span>get <span class="s2">"/listBars"</span>, <span class="o">(</span>data<span class="o">)</span> -＞
    <span class="nv">$.</span>each data, <span class="o">(</span>index, item<span class="o">)</span> -＞
      <span class="k">$(</span><span class="s2">"#bars"</span><span class="k">)</span>.append <span class="s2">"＜li＞Bar "</span> + item.name + <span class="s2">"＜/li＞"</span></code></pre></figure>

<p>CoffeScriptは、”/listBars”へのGETリクエストの作成と返却値の反復、ページ(Step 12で追加します)の”bars”エレメントへの各アイテムの追加のために、jQueryを使います。</p>

<p>Step 12) CoffeeScriptのソースから自動コンパイルされたindex.jsスクリプトを使うために、”app/views/index.scala.html”を以下の行を”main”ブロックへ追加し、更新します。</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">　＜script <span class="nv">src</span><span class="o">=</span><span class="s2">"＠routes.Assets.at("</span>javascripts/index.js<span class="s2">")"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span>＞＜/script＞
 
    　＜ul <span class="nv">id</span><span class="o">=</span><span class="s2">"bars"</span>＞＜/ul＞</code></pre></figure>

<p>ブラウザで、<a href="http://localhost:9000/">http://localhost:9000/</a>を表示し、barがページ上部に表示され、新しいbarが期待通りに追加されていることを確認してください。</p>

<p>これで、Scala, Anorm, JSON, CoffeeScript, jQueryを使ったPlay2アプリのビルド完了です。ここで紹介したすべてのソースコードはGitHub上にあります。あとはHerokuへデプロイするだけです。</p>


    </div>
    <div class="footer">
      <span class="social-button">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://modalsoul.github.io/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html/" data-via="modal_soul" data-lang="ja">ツイート</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <a href="http://b.hatena.ne.jp/entry/modalsoul.github.io/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html" class="hatena-bookmark-button" data-hatena-bookmark-title="【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery&Heroku ［Play2アプリのビルド編］" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
    <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
  </a>
  <div class="fb-like" data-href="http://modalsoul.github.io/programing/2012/02/29/play2-scala-anorm-json-coffeescript-jquery-heroku.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>

  <!-- このタグを +1 ボタンを表示する場所に挿入してください -->
  <g:plusone size="medium"></g:plusone>

</span>

    </div>
    <div class="post-paginator">
      
      <span class="next label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/programing/2012/03/04/play2-scala-anorm-json-coffeescript-jquery-heroku.html" aria-label="Next">
          <span aria-hidden="true">&laquo;【意訳】Tutorial：Play Framework 2 with Scala, Anorm, JSON, CoffeeScript, jQuery＆Heroku［Herokuデプロイ編］</span>
        </a>
      </span>
      
      
      <span class="previous label label-default col-lg-5 col-md-5 col-sm-5">
        <a href="/report/test/2012/02/26/jstd-handson.html" aria-label="Previous">
          <span aria-hidden="true">横浜JSTDDハンズオンに参加しました。#JSTDD&raquo;</span>
        </a>
      </span>
      
    </div>
    <div id="disqus_thread">
  <a href="http://modalsoul.github.io#disqus_thread">Link</a>
</div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = http://modalsoul.github.io; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//modalsoul.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </span>
  <span class="right-navi col-md-3 col-lg-3">
    <h3>Latest post:</h3>
    <ul class="post-list">
      
        <li><a href="/programming/2017/02/02/openwhisk-scala-sbt-giter8-template.html">OpenWhiskのScala sbtプロジェクトのgiter8テンプレートを作った</a></li>
      
        <li><a href="/programming/2017/01/24/serverless-architecture-starting-with-openwhisk-and-scala.html">OpenWhisk+Scalaで作るServerless Architectureとっかかり</a></li>
      
        <li><a href="/programming/2017/01/22/deploy-playframework-application-to-bluemix.html">BluemixにPlayframeworkアプリケーションをデプロイする</a></li>
      
        <li><a href="/programming/2017/01/20/giter8-sbt-new-integration.html">sbt、Giter8を統合するってよ</a></li>
      
        <li><a href="/programming/2016/11/10/scala-sam-type.html">Scala 2.12.0でSAM型</a></li>
      
    </ul>
    <h3>Recent Books:</h3>
    <ul class="books-list">
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=427421933X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/427421933X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=427421933X&linkCode=as2&tag=modalsoul-22" target="_blank">
      新装版 達人プログラマー 職人から名匠への道
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4798046140&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4798046140/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4798046140&linkCode=as2&tag=modalsoul-22" target="_blank">
      プリンシプル オブ プログラミング3年目までに身につけたい一生役立つ101の原理原則
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4844381490&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4844381490/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4844381490&linkCode=as2&tag=modalsoul-22" target="_blank">
      Scalaスケーラブルプログラミング第3版
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4822251551&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/4822251551/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4822251551&linkCode=as2&tag=modalsoul-22" target="_blank">
      SOFT SKILLS ソフトウェア開発者の人生マニュアル
    </a>
  </div>
</div>

</li>
      
        <li>
<div class="book-panel col-lg-12 col-md-12 col-sm-6 col-xs-6">
  <a target="_blank" href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22">
    <img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=487311750X&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=modalsoul-22" >
  </a>
  <div class="item_detail">
    <a href="http://www.amazon.co.jp/gp/product/487311750X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487311750X&linkCode=as2&tag=modalsoul-22" target="_blank">
      Sparkによる実践データ解析 ―大規模データのための機械学習事例集
    </a>
  </div>
</div>

</li>
      
    </ul>
  </span>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
)</li>

</ul>

<div id="tag-cloud">
  Jekyll::Drops::SiteDrop
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">modal_soul debriefing</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>modal_soul debriefing</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/modalsoul"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">modalsoul</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/modal_soul"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">modal_soul</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I guess you could call it a failure, but I prefer the term learning experience.</p>
      </div>
    </div>

  </div>

</footer>


    <script id="dsq-count-scr" src="//modalsoul.disqus.com/count.js" async></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29102099-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
